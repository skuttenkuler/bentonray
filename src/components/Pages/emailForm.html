<html>
    <form id="contactForm">
        <label className="label">First Name</label>
            <input type= "text" name="firstname" placeholder="First name.." required/>

        <label className="label">Last Name</label>
            <input type="text"id="lname" name="lastname" placeholder="Last name.." required/>

        <label className="label">Email</label>
            <input type="email"id="email"name="email"placeholder="Your email.." required/>

        <label className="label">Message</label>
            <textarea id="message" name="content" placeholder="Write something.." required>
            </textarea>
            <div id="toast"></div>
            <button className="contact_button" type="submit" id="submit"><label className="label">Send</label></button>
    </form>
</html>

<script>
    const form = document.getElementById('contactForm')
        const url = 'https://mrl9eexx69.execute-api.us-east-1.amazonaws.com/dev/email/send'
        const toast = document.getElementById('toast')
        const submit = document.getElementById('submit')

        function post(url, body, callback) {
        var req = new XMLHttpRequest();
        req.open("POST", url, true);
        req.setRequestHeader("Content-Type", "application/json");
        req.addEventListener("load", function () {
            if (req.status < 400) {
            callback(null, JSON.parse(req.responseText));
            } else {
            callback(new Error("Request failed: " + req.statusText));
            }
        });
        req.send(JSON.stringify(body));
        }
        function success () {
        toast.innerHTML = 'Thanks for sending me a message! I\'ll get in touch with you ASAP. :)'
        submit.disabled = false
        submit.blur()
        form.name.focus()
        form.name.value = ''
        form.email.value = ''
        form.content.value = ''
        }
        function error (err) {
        toast.innerHTML = 'There was an error with sending your message, hold up until I fix it. Thanks for waiting.'
        submit.disabled = false
        console.log(err)
        }

        form.addEventListener('submit', function (e) {
        e.preventDefault()
        toast.innerHTML = 'Sending'
        submit.disabled = true

        const payload = {
            name: form.name.value,
            email: form.email.value,
            content: form.content.value
        }
        post(url, payload, function (err, res) {
            if (err) { return error(err) }
            success()
  })});
</script>